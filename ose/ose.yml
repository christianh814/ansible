---
# This playbook deploys the whole OSE stack.

- name: apply common configuration to all servers
  hosts: all
  remote_user: "{{ uservar}}"
  roles:
    - common

- name: Install broker componets
  hosts: broker
  remote_user: "{{ uservar}}"
  roles:
    - broker

- name: Install Node componets - Small
  hosts: node-small
  remote_user: "{{ uservar}}"
  vars:
    node_profile: small
  roles:
    -  nodes

- name: Broker PostDeploy
  hosts: broker
  remote_user: "{{ uservar}}"
  tasks:
    - include: tasks/broker_postdeploy.yml
